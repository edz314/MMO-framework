-- Define the NPC object
NPC = {
    name = "Bandit",  -- NPC's name
    health = 10,  -- NPC's current health
    is_begging = false,  -- Indicates whether the NPC is currently begging for mercy
}

-- Define the enemy or player character
enemy = {
    name = "Hero",
    position = {x = 6, y = 5},  -- Current position of the enemy
}

-- Function to calculate the distance between two points
function calculate_distance(point1, point2)
    local dx = point2.x - point1.x
    local dy = point2.y - point1.y
    return math.sqrt(dx * dx + dy * dy)
end

-- Beg for Mercy action function
function beg_for_mercy_action()
    -- Check if the NPC's health is low enough to beg for mercy
    if NPC.health <= 20 then
        -- NPC starts begging for mercy
        NPC.is_begging = true
        print(NPC.name .. " drops to their knees and begs " .. enemy.name .. " for mercy.")
        
        -- Optional: Add conditions for how the enemy reacts to the begging
        local distance_to_enemy = calculate_distance(NPC.position, enemy.position)
        if distance_to_enemy <= 2 then
            print(enemy.name .. " is close enough to hear the plea.")
            -- The enemy might decide to spare, ignore, or attack based on their disposition
            local enemy_response = math.random(1, 3)
            if enemy_response == 1 then
                print(enemy.name .. " decides to spare " .. NPC.name .. ".")
                -- The NPC could gain their freedom or be captured
            elseif enemy_response == 2 then
                print(enemy.name .. " ignores the plea and remains indifferent.")
                -- The situation remains tense
            else
                print(enemy.name .. " attacks despite the plea!")
                -- The NPC might receive a final blow
                NPC.health = 0
                print(NPC.name .. " has been defeated.")
            end
        else
            print(enemy.name .. " is too far away to hear the plea.")
        end
    else
        print(NPC.name .. " is not desperate enough to beg for mercy.")
    end
end

-- Example usage:
-- Execute the beg for mercy action
beg_for_mercy_action()

-- Output the NPC's status after begging
if NPC.health > 0 then
    if NPC.is_begging then
        print(NPC.name .. " is still alive, hoping for mercy.")
    else
        print(NPC.name .. " is holding on, not yet begging for mercy.")
    end
else
    print(NPC.name .. " has perished.")
end
