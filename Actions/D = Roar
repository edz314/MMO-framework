-- Define the NPC object
NPC = {
    name = "Beast",  -- NPC's name for roar messages
    roar_message = "RAAAWWWRRR!",  -- The roar sound/message
    roar_range = 15,  -- Range within which roar is effective
    roar_intimidation = 3,  -- Intimidation level added to targets within range
    position = {x = 0, y = 0},
    target_list = {},  -- List of potential targets
}

-- Function to calculate the distance between NPC and target
function calculate_distance(target_position)
    local dx = target_position.x - NPC.position.x
    local dy = target_position.y - NPC.position.y
    return math.sqrt(dx * dx + dy * dy)
end

-- Roar action function
function roar_action()
    print(NPC.name .. " roars: \"" .. NPC.roar_message .. "\"")

    -- Loop through all targets to check if they are within roar range
    for i, target in ipairs(NPC.target_list) do
        local distance_to_target = calculate_distance(target.position)

        -- If the target is within range, apply the roar effect
        if distance_to_target <= NPC.roar_range then
            target.fear_level = (target.fear_level or 0) + NPC.roar_intimidation
            print("Target " .. i .. " is intimidated! Fear level increased to " .. target.fear_level)
        else
            print("Target " .. i .. " is out of roar range.")
        end
    end
end

-- Example usage:
-- Define multiple targets with positions and fear levels
target_1 = {
    position = {x = 10, y = 10},
    fear_level = 1,  -- Initial fear level
}

target_2 = {
    position = {x = 20, y = 20},
    fear_level = 2,  -- Initial fear level
}

-- Assign the targets to the NPC's target list
NPC.target_list = {target_1, target_2}

-- Execute the roar action
roar_action()
